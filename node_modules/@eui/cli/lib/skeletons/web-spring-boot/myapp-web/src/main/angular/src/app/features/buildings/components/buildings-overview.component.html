<div class="col-sm-8">
    <ux-panel label="List of buildings" [isBlocked]="mode === 'load'">
        <uxPanelHeaderRightContent>
            <button *ngIf="buildingsPage && mode === 'view'" class="btn btn-secondary" (click)="setMode('edit')">Modify</button>
            <button *ngIf="buildingsPage && mode === 'edit'" class="btn btn-secondary" (click)="setMode('view')"><span class="fa fa-close"></span> Done</button>
        </uxPanelHeaderRightContent>
        <uxPanelFooter *ngIf="buildingsPage && mode !== 'load'">
            <p-paginator [first]="buildingsPage.from" [rows]="buildingsPage.pageSize" [totalRecords]="buildingsPage.total" (onPageChange)="onPageChange($event)"></p-paginator>
        </uxPanelFooter>

        <ng-container *ngIf="buildingsPage && mode !== 'load'; else loading">
            <div class="row">
                <div class="col-5">
                    <ux-a-label label="Name of building"></ux-a-label>
                </div>
                <div class="col-5">
                    <ux-a-label label="Address"></ux-a-label>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <hr/>
                </div>
            </div>
            <ng-container *ngFor="let building of buildingsPage.items">
                <div class="row">
                    <div class="col-5 p-2">{{building.name}}</div>
                    <div class="col-5 p-2">
                <span *ngIf="building.address as address">
                    {{address.street}}<br/>
                    {{address.postalCode}} - {{address.city}}<br/>
                    {{address.country}}
                </span>
                    </div>
                    <div class="col-1 p-2 align-self-center">
                        <button *ngIf="mode === 'edit'" class="btn btn-secondary" (click)="deleteBuilding(building.buildingId)"><span class="fa fa-trash"></span></button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <hr/>
                    </div>
                </div>
            </ng-container>
        </ng-container>

        <ng-template #loading>
            <ng-container *ngIf="! serviceError; else error">
                Loading...
            </ng-container>
        </ng-template>

        <ng-template #error>
            <ux-alert typeClass="warning">
                Unable to retrieve the list of buildings; please <a (click)="loadBuildings()">try again</a> later.<br/>
                If the problem persists, please contact the administrator.<br/>
                <br/>
                <a (click)="serviceErrorVisible = !serviceErrorVisible">
                    <span *ngIf="!serviceErrorVisible">Show technical reason</span>
                    <span *ngIf="serviceErrorVisible">Hide technical reason</span>
                </a>
                <pre *ngIf="serviceErrorVisible">{{serviceError.message}}</pre>
            </ux-alert>
        </ng-template>
    </ux-panel>
</div>
